<%= render "shared/bottom_navbar" %>

<div class="container py-5" style="background-color: #f0f8ff;"> <!-- AliceBlue -->

  <div class="text-center mb-5">
    <h1 class="display-5 fw-bold text-primary"><%= @pharmacy.name %></h1>
    <p class="lead text-muted"><%= @pharmacy.description %></p>
  </div>

  <div class="text-center mb-4">
    <%= link_to 'Write a review', new_pharmacy_review_path(@pharmacy), class: "showreview" %>
  </div>

  <nav>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
      <button class="nav-link active" id="nav-products-tab" data-bs-toggle="tab" data-bs-target="#nav-products" type="button" role="tab" aria-controls="nav-products" aria-selected="true">Products</button>
      <button class="nav-link" id="nav-reviews-tab" data-bs-toggle="tab" data-bs-target="#nav-reviews" type="button" role="tab" aria-controls="nav-reviews" aria-selected="false">Reviews</button>
    </div>
  </nav>

  <div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-products" role="tabpanel" aria-labelledby="nav-products-tab">
      <% if @products.any? %>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          <% @products.each do |product| %>
            <div class="col d-flex">
              <div class="card shadow-sm w-100 d-flex flex-column">
                <div class="card-image">
                  <% if product.images.any? %>
                    <%= cl_image_tag product.images.first.key, height: 300, width: 400, crop: :fill, class: "card-img-top" %>
                  <% else %>
                    <img src="https://via.placeholder.com/400x300?text=No+Image" alt="No Image" class="card-img-top">
                  <% end %>
                </div>

                <div class="card-body text-center flex-grow-1 d-flex flex-column">
                  <h5 class="card-title text-primary"><%= product.name %></h5>

                  <% pharmacy_product = PharmacyProduct.find_by(pharmacy_id: @pharmacy.id, product_id: product.id) %>

                  <p class="card-text"><%= product.description %></p>

<<<<<<< HEAD
                  <!-- Quantity and Add to Basket -->
                  <div class="mt-auto d-flex justify-content-center align-items-center gap-2">
                    <%= simple_form_for [@pharmacy, @basket_item] do |f| %>
                    <%= f.input :quantity %>
                    <%= f.input :product_id, as: :hidden, input_html: { value: product.id, class: "form-control form-control-sm quantity-input"} %>
                    <%= f.submit "Add to Basket", class: "btn btn-success btn-sm add-to-basket-btn" %>
=======
                  <!-- Quantity, Price and Add to Basket in one row -->
                  <div class="mt-auto d-flex justify-content-center align-items-center gap-2 flex-wrap">
                    <%= simple_form_for [@pharmacy, @basket_item], html: { class: "d-flex align-items-center gap-2 flex-wrap mb-0" } do |f| %>
                      <%= f.input :quantity, label: false, input_html: { class: "form-control form-control-sm", style: "width: 70px;" } %>
                      <%= f.input :product_id, as: :hidden, input_html: { value: product.id } %>

                      <% if pharmacy_product&.price.present? %>
                        <span class="text-success fw-bold">Â£<%= number_with_precision(pharmacy_product.price, precision: 2) %></span>
                      <% end %>

                      <%= f.submit "Add to Basket", class: "btn btn-success btn-sm" %>
>>>>>>> 0a8bf63839e9fd9aba9c42ca38c8a593f039522f
                    <% end %>
                  </div>

                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="alert alert-info text-center mt-4">
          No products available for this pharmacy.
        </div>
      <% end %>
    </div>

    <div class="tab-pane fade" id="nav-reviews" role="tabpanel" aria-labelledby="nav-reviews-tab">
      <% if @pharmacy.reviews.empty? %>
        <div class="alert alert-info text-center mt-4">
          No reviews yet. Be the first to leave a review!
        </div>
      <% else %>
        <% @pharmacy.reviews.each do |review| %>
          <p><%= review.rating %> stars</p>
          <p><%= review.description %></p>
        <% end %>
      <% end %>
    </div>
  </div>
</div>

<<<<<<< HEAD
=======



<a id="sticky-basket-icon"
   href="/baskets/1"
   aria-label="View Basket"
   class="position-fixed shadow-lg"
   style="
     bottom: 80px;
     right: 20px;
     z-index: 9999;
     width: 64px;
     height: 64px;
     background: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%);
     color: white;
     border-radius: 50%;
     display: flex;
     align-items: center;
     justify-content: center;
     transition: transform 0.3s ease, box-shadow 0.3s ease;
     box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
   "
   onmouseover="this.style.transform='scale(1.1)'"
   onmouseout="this.style.transform='scale(1)'">
   <i class="fas fa-shopping-basket fa-lg"></i>
</a>





>>>>>>> 0a8bf63839e9fd9aba9c42ca38c8a593f039522f
<!-- CSS -->
<style>
  .card:hover {
    transform: translateY(-4px);
    box-shadow: 0 0.5rem 1.2rem rgba(0, 0, 0, 0.1);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .card-title {
    font-size: 1.1rem;
  }

  .showreview {
  display: inline-block;
  background-color: #5a2fc2; // Matching the purple accent
  color: color: #ffffff;
  padding: 10px 18px;
  border-radius: 8px;
  font-weight: 600;
  text-decoration: none;
  transition: background-color 0.3s ease;

  &:hover {
    background-color: #4b24a8;
  }

  &:active {
    background-color: #3c1c89;
  }
}


  #sticky-basket-summary {
    backdrop-filter: blur(6px);
  }
</style>
